<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sword Effects Test</title>
<style>
    body { margin:0; overflow:hidden; background:#000 }
    #hint {
        position:fixed;
        bottom:10px;
        left:50%;
        transform:translateX(-50%);
        color:white;
        font-family:Arial;
        opacity:0.7;
    }
</style>
</head>
<body>
<div id="hint">Left Click = Swing Sword</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.161.0/build/three.min.js"></script>

<script>
/* =============== SCENE =============== */
const scene = new THREE.Scene()
scene.fog = new THREE.Fog(0x111111, 10, 60)

/* =============== CAMERA =============== */
const camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 500)
camera.position.set(0,1.7,0)

/* =============== RENDERER =============== */
const renderer = new THREE.WebGLRenderer({ antialias:true })
renderer.setSize(innerWidth, innerHeight)
renderer.shadowMap.enabled = true
document.body.appendChild(renderer.domElement)

/* =============== LIGHTING =============== */
const light = new THREE.DirectionalLight(0xfff1d6, 1.2)
light.position.set(10,20,10)
light.castShadow = true
scene.add(light)

scene.add(new THREE.AmbientLight(0x404040))

/* =============== GROUND =============== */
const ground = new THREE.Mesh(
    new THREE.PlaneGeometry(100,100),
    new THREE.MeshStandardMaterial({ color:0x3a3a3a })
)
ground.rotation.x = -Math.PI/2
ground.receiveShadow = true
scene.add(ground)

/* =============== PLAYER ROOT =============== */
const player = new THREE.Group()
player.position.y = 0
scene.add(player)

/* =============== SWORD =============== */
const sword = new THREE.Group()

// Blade
const blade = new THREE.Mesh(
    new THREE.BoxGeometry(0.08,1.4,0.15),
    new THREE.MeshStandardMaterial({
        color:0xcccccc,
        metalness:0.9,
        roughness:0.2
    })
)
blade.position.y = 0.8
blade.castShadow = true
sword.add(blade)

// Handle
const handle = new THREE.Mesh(
    new THREE.CylinderGeometry(0.06,0.06,0.4,12),
    new THREE.MeshStandardMaterial({
        color:0x3b2a1a,
        roughness:0.9
    })
)
handle.position.y = 0.2
sword.add(handle)

// Guard
const guard = new THREE.Mesh(
    new THREE.BoxGeometry(0.4,0.05,0.15),
    new THREE.MeshStandardMaterial({ color:0x999999 })
)
guard.position.y = 0.45
sword.add(guard)

/* Position sword relative to camera (hand) */
sword.position.set(0.6,-0.6,-1)
sword.rotation.set(0.3,0,0.2)
camera.add(sword)
scene.add(camera)

/* =============== SWING ANIMATION =============== */
let swinging = false
let swingTime = 0

function swingSword(){
    if(swinging) return
    swinging = true
    swingTime = 0
}

addEventListener("mousedown", swingSword)

/* =============== ANIMATE =============== */
function animate(){
    requestAnimationFrame(animate)

    /* Sword swing curve */
    if(swinging){
        swingTime += 0.15

        sword.rotation.z = Math.sin(swingTime) * -1.2
        sword.rotation.x = 0.3 + Math.sin(swingTime) * 0.3

        if(swingTime > Math.PI){
            sword.rotation.set(0.3,0,0.2)
            swinging = false
        }
    }

    renderer.render(scene,camera)
}
animate()

/* =============== RESIZE =============== */
addEventListener("resize", ()=>{
    camera.aspect = innerWidth/innerHeight
    camera.updateProjectionMatrix()
    renderer.setSize(innerWidth,innerHeight)
})
</script>
</body>
</html>
